<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Money Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="dashboard">

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>
</div>

<header>
    <div class="header-content">
        <h1>üí∞ Money Tracker</h1>
        <div class="user-info">
            <span id="welcomeUser" class="welcome-text">Welcome!</span>
        </div>
    </div>
    <div class="header-actions">
        <button type="button" onclick="exportData()" class="export-btn" aria-label="Export Data">
            üìä Export
        </button>
        <button type="button" class="dark-toggle" id="darkToggle" aria-label="Toggle Dark Mode">
            üåô Dark Mode
        </button>
        <button type="button" onclick="logout()" class="logout-btn" aria-label="Logout">
            üö™ Logout
        </button>
    </div>
</header>

<main>
    <!-- Quick Stats Dashboard -->
    <section class="stats-section">
        <h2>üìä Quick Overview</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-content">
                    <h3 id="totalPeople">0</h3>
                    <p>Total People</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìù</div>
                <div class="stat-content">
                    <h3 id="totalTransactions">0</h3>
                    <p>Transactions</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∏</div>
                <div class="stat-content">
                    <h3 id="totalSentStat">‚Çπ0</h3>
                    <p>Total Sent</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-content">
                    <h3 id="totalReceivedStat">‚Çπ0</h3>
                    <p>Total Received</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Person -->
    <section>
        <h2>‚ûï Add Person</h2>
        <form id="personForm" class="form-card" novalidate>
            <div class="input-wrapper">
                <label for="personName">Person Name</label>
                <input
                        type="text"
                        id="personName"
                        placeholder="Enter person name"
                        required
                        minlength="2"
                        maxlength="50"
                        autocomplete="off"
                >
                <div class="input-error" id="personNameError"></div>
            </div>
            <button type="submit" class="add-btn" id="addPersonBtn">
                <span class="btn-text">Add Person</span>
                <span class="btn-loading">Adding...</span>
            </button>
        </form>
    </section>

    <!-- People List with Search -->
    <section>
        <div class="section-header">
            <h2>üë• People</h2>
            <div class="search-container">
                <input
                        type="search"
                        id="peopleSearch"
                        placeholder="Search people..."
                        class="search-input"
                        autocomplete="off"
                >
                <span class="search-icon">üîç</span>
            </div>
        </div>
        <div class="table-container">
            <table id="peopleTable">
                <thead>
                <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Balance</th>
                    <th scope="col">Last Transaction</th>
                    <th scope="col">Actions</th>
                </tr>
                </thead>
                <tbody id="peopleList">
                <tr class="loading-row">
                    <td colspan="4">
                        <div class="table-loading">
                            <div class="loading-dots"></div>
                            Loading people...
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Transaction Forms -->
    <div class="transaction-forms">
        <!-- Send Money -->
        <section class="transaction-section">
            <h2>üì§ Send Money</h2>
            <form id="sendForm" class="transaction-form" novalidate>
                <div class="input-wrapper">
                    <label for="sendName">Select Person</label>
                    <select id="sendName" required>
                        <option value="">Choose person...</option>
                    </select>
                    <div class="input-error" id="sendNameError"></div>
                </div>
                <div class="input-wrapper">
                    <label for="sendAmount">Amount (‚Çπ)</label>
                    <input
                            type="number"
                            id="sendAmount"
                            placeholder="0.00"
                            min="0.01"
                            max="1000000"
                            step="0.01"
                            required
                    >
                    <div class="input-error" id="sendAmountError"></div>
                </div>
                <div class="input-wrapper">
                    <label for="sendDesc">Description</label>
                    <input
                            type="text"
                            id="sendDesc"
                            placeholder="Optional description"
                            maxlength="200"
                    >
                    <div class="char-count" id="sendDescCount">0/200</div>
                </div>
                <button type="submit" class="send-btn" id="sendBtn">
                    <span class="btn-text">üí∏ Send Money</span>
                    <span class="btn-loading">Sending...</span>
                </button>
            </form>
        </section>

        <!-- Receive Money -->
        <section class="transaction-section">
            <h2>üì• Receive Money</h2>
            <form id="receiveForm" class="transaction-form" novalidate>
                <div class="input-wrapper">
                    <label for="receiveName">Select Person</label>
                    <select id="receiveName" required>
                        <option value="">Choose person...</option>
                    </select>
                    <div class="input-error" id="receiveNameError"></div>
                </div>
                <div class="input-wrapper">
                    <label for="receiveAmount">Amount (‚Çπ)</label>
                    <input
                            type="number"
                            id="receiveAmount"
                            placeholder="0.00"
                            min="0.01"
                            max="1000000"
                            step="0.01"
                            required
                    >
                    <div class="input-error" id="receiveAmountError"></div>
                </div>
                <div class="input-wrapper">
                    <label for="receiveDesc">Description</label>
                    <input
                            type="text"
                            id="receiveDesc"
                            placeholder="Optional description"
                            maxlength="200"
                    >
                    <div class="char-count" id="receiveDescCount">0/200</div>
                </div>
                <button type="submit" class="receive-btn" id="receiveBtn">
                    <span class="btn-text">üí∞ Receive Money</span>
                    <span class="btn-loading">Processing...</span>
                </button>
            </form>
        </section>
    </div>

    <!-- Transactions -->
    <section class="transactions-section">
        <div class="section-header">
            <h2>üìë Transaction History</h2>
            <div class="transaction-controls">
                <input
                        type="search"
                        id="transactionSearch"
                        placeholder="Search transactions..."
                        class="search-input"
                >
                <select id="transactionFilter" class="filter-select">
                    <option value="all">All Transactions</option>
                    <option value="send">Sent Only</option>
                    <option value="receive">Received Only</option>
                    <option value="reversed">Reversed Only</option>
                </select>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="summary-cards">
            <div class="summary-card sent">
                <div class="card-icon">üì§</div>
                <div class="card-content">
                    <h3>Total Sent</h3>
                    <p id="totalSent">‚Çπ0</p>
                    <small id="sentCount">0 transactions</small>
                </div>
            </div>
            <div class="summary-card received">
                <div class="card-icon">üì•</div>
                <div class="card-content">
                    <h3>Total Received</h3>
                    <p id="totalReceived">‚Çπ0</p>
                    <small id="receivedCount">0 transactions</small>
                </div>
            </div>
            <div class="summary-card balance">
                <div class="card-icon">üí∞</div>
                <div class="card-content">
                    <h3>Net Balance</h3>
                    <p id="netBalance">‚Çπ0</p>
                    <small id="balanceStatus">Even</small>
                </div>
            </div>
        </div>

        <!-- Grouped Transaction List -->
        <div id="transactionsContainer" class="transactions-list">
            <div class="loading-transactions">
                <div class="loading-dots"></div>
                <p>Loading transactions...</p>
            </div>
        </div>
    </section>
</main>

<!-- Enhanced Notification System -->
<div id="notificationContainer" class="notification-container" role="alert" aria-live="polite">
</div>

<!-- Confirmation Modal -->
<div id="confirmModal" class="modal" role="dialog" aria-labelledby="confirmTitle" aria-hidden="true">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="confirmTitle">Confirm Action</h3>
            <button class="modal-close" onclick="closeModal()" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
            <p id="confirmMessage">Are you sure?</p>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeModal()">Cancel</button>
            <button class="btn-danger" id="confirmBtn">Confirm</button>
        </div>
    </div>
</div>

<!-- Connection Status -->
<div id="connectionStatus" class="connection-status">
    <span class="status-indicator"></span>
    <span class="status-text">Connected</span>
</div>

<!-- Scripts -->
<script src="script.js"></script>
</body>
</html>